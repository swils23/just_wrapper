# autoload

function just_wrapper() {
    if [[ $# -lt 1 ]]; then
        echo "Usage: just_wrapper <command> [args]"
        return 1
    fi

    case $1 in
        # Default commands provided by just_wrapper plugin
        just_wrapper_edit)
            code "$JW_COMMANDS_DIR"
            ;;
        just_wrapper_reload)
            exec $SHELL
            ;;
        just_wrapper_update)
            bash <(curl -s https://raw.githubusercontent.com/swils23/just_wrapper/main/install_script) $ZSH_CUSTOM
            ;;
        *)
            # Command overrides
            if echo "$JW_COMMANDS" | grep -qw "$1"; then
                # Set .commands file as executable
                chmod +x "$JW_COMMANDS_FILE"
                # Call .commands file with the name of the function and any additional arguments
                "$JW_COMMANDS_FILE" "$@"
            
            # Script overrides
            elif echo "$JW_SCRIPTS" | grep -qw "$1"; then
                # Set script as executable
                chmod +x "$JW_COMMANDS_DIR/$1"
                # Call script with any additional arguments
                "$JW_COMMANDS_DIR/$1" "${@:2}"
            # Fallback to just
            else
                just "$@"
            fi
            ;;
    esac
}

just_wrapper "$@"